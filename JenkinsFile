@Library('shared-library_301') _
node(label: 'master'){

//for git
def gitURL = "https://github.com/shruti-singh26/Spring-MySql-Docker.git"
def gitBranch = "master"

//for maven
def mvnHome = "maven"
def pom = "pom.xml"
def goal = "clean install"

//for sonar
def sonarqubeServer = "sonar"
def sonarqubeGoal = "clean verify sonar:sonar"

//for artifactory
def artifactoryServer = "JFrog-artifactory"
def releaseRepo = "shruti-123"
def snapshotRepo = "shruti-123"

//for devDeployment
def source = "\target\*.jar"
def dest = "/home/ubuntu"
def IP = ""
def user = "ubuntu"

stage ("Git Checkout"){
	GitCheckOut "${gitURL}","${gitBranch}"
}

stage('Sonarqube Scanning'){
    sonarqubeScan "${mvnHome}","${sonarqubeGoal}","${pom}", "${sonarqubeServer}"
}

stage('Quality-Gate-check'){
    qualityGate "${sonarqubeServer}"
}

stage('Maven Build and Push to JFrog'){
     mavenBuild "${artifactoryServer}","${mvnHome}","${pom}", "${goal}", "${releaseRepo}", "${snapshotRepo}"
}

stage (Deploy in Dev){
     devDeploy "${source}","${dest}","${IP}","${user}"
}
}